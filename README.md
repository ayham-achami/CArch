# CArch

## üìÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

![–°–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](ReadmeResourses/CArch.png)

> [**Presentation Layer**](#Presentation-layer)

* [Assembly](#üìí-Assembly)
* [View](#üìí-View)
* [Renderer](#üìí-Renderer)
* [State](#üìí-State)
* [Provider](#üìí-Provider)
* [Presenter](#üìí-Presenter)
* [Router](#üìí-Router)

> [**Business Logic**](#Business-Logic)

* [Private](#üìí-Private)
* [Public](#üìí-Public)
* [Assembly](#üìí-Assembly)

> **Model Layer**

* Managable: –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ë–î
* Parameters: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
* Responses: –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ API
* UniversalModel: –ª—é–±—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã/–æ—Ç–≤–µ—Ç –ª—é–±–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

> [**–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª**](#üîÑ-–ü–æ–ª–Ω—ã–π-—Ü–∏–∫–ª)

# Presentation Layer

![Presentation Layer](ReadmeResourses/Module.png)

üìÑ –í—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–≤—è–∑–∞–Ω–∞ –Ω–∞ **–ø—Ä–æ—Ç–æ–∫–æ–ª–∞—Ö**, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–¥–º–µ–Ω—É –∫–∞–∫–∏—Ö-–ª–∏–±–æ –º–æ–¥—É–ª–µ–π –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–î–ª—è `VC` —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª `–•RenderingLogic`, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –ª–æ–≥–∏–∫—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

–î–ª—è `Provider` —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª `–•ProvisionLogic`, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –ª–æ–≥–∏–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–ª–æ—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.

–î–ª—è `Presenter` —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª `–•PresentationLogic`, —Å—Å—ã–ª–∫–∞ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ Provider –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—ã–∑–æ–≤–∞.

–î–ª—è `Router` —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª `–•RoutingLogic`, –æ—Ä–≥–∞–Ω–∏–∑—É—é—â–∏–π –ª–æ–≥–∏–∫—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –æ—Ç –º–æ–¥—É–ª—è `–•` –≤ –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏

## üìù –ú–æ–¥—É–ª—å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:

## üìí **Assembly**

* **class XAssebly**  
–û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ - —Å–æ–±—Ä–∞—Ç—å –º–æ–¥—É–ª—å. –¢—É—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è View, Provider, Presenter, Router  
* **struct XModule**
  * class Convertor - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç storyboard, –≤–æ–∑–≤—Ä–∞—â–∞—è –Ω–∞–∑–≤–∞–Ω–∏–µ ViewController'a.
  * class Builder
    * –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏–µ—Ä–∞—Ä—Ö–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–æ–¥—É–ª—è
    * —Å–æ–∑–¥–∞—Ç—å/–≤—ã—Ç–∞—â–∏—Ç—å –∏–∑ —Å—Ç–æ—Ä–∏–±–æ—Ä–¥–∞ ViewController, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å —Ç—É–¥–∞ InitialState

* **–ï—Å—Ç—å 2 —Å–æ—Å—Ç–æ—è–Ω–∏—è:**  
        - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ - —á—Ç–æ –ø–µ—Ä–µ–¥–∞–µ–º –≤ –º–æ–¥—É–ª—å  
        - –§–∏–Ω–∞–ª—å–Ω–æ–µ (–µ—Å—Ç—å –Ω–µ –≤—Å–µ–≥–¥–∞) - —Ç–æ, —á—Ç–æ –≤—ã–¥–∞–µ—Ç –º–æ–¥—É–ª—å –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö  

–ü–µ—Ä–µ–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –º–æ–¥—É–ª—å –∏ –æ–∂–∏–¥–∞–µ–º   –æ–±—Ä–∞–±–æ—Ç–∫–∏, –ø–æ–ª—É—á–∞–µ–º –Ω–∞ –≤—ã—Ö–æ–¥–µ –∫–∞–∫–∏–µ-—Ç–æ –¥–∞–Ω–Ω—ã–µ.

## üìí **View**

> –û—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Renderer. –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∏–∫–∞–∫–æ–π –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–µ—Ç—å—é, –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –ï–≥–æ –∑–∞–¥–∞—á–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è —Å View, –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ (–±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫) –≤ Provider.

–ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—è–∂–µ–ª–æ–π –ª–æ–≥–∏–∫–∏, –Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –µ–π. –í—Å–µ —Å–æ–±—ã—Ç–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –Ω–µ–≥–æ.

**protocol ProvisionLogic** - –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç Provider.

**typealias UserInteraction** - —Å–±–æ—Ä –≤—Å–µ—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ interaction'–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω—ã –≤ Renderer

**let moduleReference** - —Å—Å—ã–ª–∫–∞ –Ω–∞ Assembly.

## **–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª VC**

–ó–∞ –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ—Ç–≤–µ—á–∞–µ—Ç VC - moduleLifeCycleOwner

**var lifeCycle** - –º–∞—Å—Å–∏–≤ —Ä–µ–Ω–¥–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ VC.

## **–°–±–æ—Ä–∫–∞ –º–æ–¥—É–ª—è**

–ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–µ–º VC, –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ **moduleReference** –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞, —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç assembly –∏ –º—ã –ø–µ—Ä–µ–¥–∞–µ–º —Ç—É–¥–∞ —Ç–∏–ø –º–æ–¥—É–ª—è (Module.Type), –∫–æ—Ç–æ—Ä—ã–π —É –Ω–∞—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è (—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ register view, provider, router, presenter)

## üìí **Renderer**

–û–±—ä–µ–∫—Ç —á–∞—Å—Ç–∏ ViewController.

* –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, cell –∏–ª–∏ tabBar)
* –ú–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ View –∏ —á—Ç–æ-—Ç–æ –ø–æ–ª—É—á–∞—Ç—å
* –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª VC (—á—Ç–æ–±—ã View –Ω–µ –¥–µ—Ä–∂–∞–ª–∞ –≤—Å–µ Renderer –∏ –Ω–µ –≥–æ–≤–æ—Ä–∏–ª–∞, —á—Ç–æ –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è)
* –°–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ –∞—É—Ç–ª–µ—Ç—ã, —ç–∫—à–µ–Ω—ã

–£ –∫–∞–∂–¥–æ–≥–æ Renderer —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–ª–∞–±–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ VC - *delegate* (–æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Renderer). VC –¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ renderer, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∞ renderer –¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ VC, —á—Ç–æ–±—ã —Å–æ–æ–±—â–∏—Ç—å –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

–ö–∞–∂–¥—ã–π Renderer –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ–Ω –¥–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. View —è–≤–ª—è–µ—Ç—Å—è –¥–µ–ª–µ–≥–∞—Ç–æ–º —ç—Ç–∏—Ö —Å–æ–±—ã—Ç–∏–π.

set(content: ...) - –∫–æ–Ω—Ç–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ typealias ModelType

## üìí **State**

–°–æ—Å—Ç–æ–∏—Ç –∏–∑ 2-—É—Ö —á–∞—Å—Ç–µ–π:

*–ù–∞—á–∞–ª—å–Ω–æ–≥–æ* —Å–æ—Å—Ç–æ—è–Ω–∏—è (initialState) –∏ *—Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ* (finalState) - –¥–µ—Ä–∂–∏—Ç –Ω–∞ –Ω–∏—Ö —Å—Å—ã–ª–∫–∏, –æ–Ω–∏ –æ–±–∞ —è–≤–ª—è—é—Ç—Å—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏.

**ModuleInitialState** - –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥—É–ª—å –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

**ModuleFinalState** - –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –º–æ–¥—É–ª—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–¥–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

–í state —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞ —Ä–µ–Ω–¥–µ—Ä–µ, –Ω–æ –∫–æ–ø–∏—é

–£ Presenter –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞ –Ω–∞ state –≤ –∫–∞—á–µ—Å—Ç–≤–µ **readOnly**

## üìí **Provider**

–û–±—Ä–∞—â–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–∏—Å—É, –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏. –¢—É—Ç –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ª–æ–≥–∏–∫–∏!

–¢—É—Ç –º—ã —Å–æ–æ–±—â–∞–µ–º –∫–∞–∫–∏–µ-—Ç–æ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª—É—á–∏–ª–∏—Å—å, —á—Ç–æ —Å–º–æ–≥–ª–∏ –ø–æ–ª—É—á–∏—Ç—å, –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã–µ/–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

## üìí **Presenter**

–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏—Ö View.

–ï—Å—Ç—å —Å—Å—ã–ª–∫–∞ –Ω–∞ View, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å —Ç—É–¥–∞ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∫–∞–∑–∞.

## üìí **Router**

–ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏.  

# Business Logic Layer

![Business Logic Layer](ReadmeResourses/Service.png)

üìù –°–µ—Ä–≤–∏—Å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:

## üìí **Assembly**

–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ Dependency Injection —Å–µ—Ä–≤–∏—Å–æ–≤, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã—Ö –≤ —Å–ª–æ–µ Private —á–µ—Ä–µ–∑ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä init.

–°–µ—Ä–≤–∏—Å–∞–º–∏ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä:

* ***HTTP –∫–ª–∏–µ–Ω—Ç***
* ***–•—Ä–∞–Ω–∏–ª–∏—â–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.***

–ü—Ä–∏–º–µ—Ä –∏–Ω—ä–µ–∫—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```Swift
func assemble(container: DIContainer) {
    container.record(AccountService.self, inScope: .autoRelease) { resolver in
        AccountServiceImplementation(resolver.unravel(RestIO.self),
                                    resolver.unravel(Repository.self, 
                                    name: RepositoryAssembly.Names.encryption),
                                    authKeychainNew)
    }
}
```

## üìí **Public**

–ë–ª–æ–∫ Public —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ `xService`, –æ–ø–∏—Å—ã–≤–∞—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã –≤ –±–ª–æ–∫–µ Private.
–ü—Ä–æ—Ç–æ–∫–æ–ª –¥–æ–ª–∂–µ–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ `BusinessLogicService` . –ó–∞–ø—Ä–µ—â–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞, –±–µ–∑ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.

## üìí **Private**

–ë–ª–æ–∫ Private —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ –∫–ª–∞—Å—Å `xServiceImplementation`, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–∏, –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ `xService`.
–¢–∞–∫ –∫–∞–∫ –ø—Ä–æ—Ç–æ–∫–æ–ª `BusinessLogicService` (–æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω –ø—Ä–æ—Ç–æ–∫–æ–ª `xService`) —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏, —Ç–æ –∏–º–µ–Ω–Ω–æ –∫–ª–∞—Å—Å `xServiceImplementation` –∏—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑:
`init(_ args: Any?...)`
–ï—Å–ª–∏ —É —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤, —Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.
–í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω—ã–π –æ–±—ä–µ–∫—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ –±—ã–ª –Ω–∞–π–¥–µ—Ç –≤ —Å–ø–∏—Å–∫–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, —Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è —Å —Ñ–∞—Ç–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–æ–π.

–¢–∞–∫–∂–µ, –ø–æ–º–∏–º–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π –∫–ª–∞—Å—Å `xServiceImplementation` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ ***HTTP*** –∫–ª–∏–µ–Ω—Ç –∏/–∏–ª–∏ ***–•—Ä–∞–Ω–∏–ª–∏—â–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞***, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ –±–ª–æ–∫–µ Assembly.

# üîÑ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª:

–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å **View**.

–î–æ–ø—É—Å—Ç–∏–º, –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –µ–≥–æ. 

–í–æ View –µ—Å—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª `–•ProvisionLogic`. –î–æ–±–∞–≤–ª—è–µ–º —Ç—É–¥–∞ –º–µ—Ç–æ–¥ obtainProfile(), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è. –í–æ viewDidLoad() –ø–∏—à–µ–º `provider.obtainProfile()` –∏ –≥–æ–≤–æ—Ä–∏–º: –ø—Ä–æ–≤–∞–π–¥–µ—Ä, –ø–æ–ª—É—á–∏ –ø—Ä–æ—Ñ–∏–ª—å.

## **Provider:**

XProvider –∏–º–ø–ª–∏–º–µ–Ω—Ç–∏—Ä—É–µ—Ç XProvisionLogic, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –≤–æ View.

–í –ø—Ä–æ–≤–∞–π–¥–µ—Ä –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ DI, —Ç.–µ –ø–∏—à–µ—Ç—Å—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –≤ —Å–µ–±—è.

```swift
init(presenter: ProfilePresentationLogic,
        accountService: AccountService,
        unauthService: UnauthorizationService,
        pushNotificationsService: PushNotificationService) {
    self.presenter = presenter
    self.accountService = accountService
    self.unauthService = unauthService
    self.pushNotificationsService = pushNotificationsService
}
```

–í XAssembly –Ω—É–∂–Ω–æ –∑–∞–∏–Ω—ä–µ–∫—Ç–∏—Ç—å –∏—Ö:

```swift
func registerProvider(in container: DIContainer) {
    container.record(ProfileProvisionLogic.self) { (resolver, presenter: ProfilePresentationLogic) in
        ProfileProvider(presenter: presenter,
                        accountService: resolver.unravel(AccountService.self)!,
                        unauthService: resolver.unravel(UnauthorizationService.self)!,
                        pushNotificationsService: resolver.unravel(PushNotificationService.self)!)
    }
}
```

–í—Å–µ –º–µ—Ç–æ–¥—ã —Å —Å–µ—Ä–≤–∏—Å–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è, –∫–∞–∫ Promise<[...]>

```swift
func fetchProfile() -> Promise<Profile>
```

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å, –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–∏—Å—É, –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥, –∞ –¥–∞–ª—å—à–µ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å compactMap/done/catch –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–¥–∞—á–∏.

```swift
func obtainProfile() {
    accountService.fetchProfile().then { profile in
        self.accountService.fetchNewsRole().map { ($0, profile) }
    }.done { newsRoleResponse, profile in
        self.presenter.didObtain(newsRole: newsRoleResponse.newsRole, profile)
    }.catch { error in
        self.presenter.encountered(error)
    }
}
```

–í —Ñ–∞–π–ª–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –µ—Å—Ç—å `XPresentationLogic`, –≥–¥–µ –Ω–∞–º –Ω—É–∂–µ–Ω didObtainProfile(), *Profile* - —Ç–æ, –∑–∞ —á–µ–º –º—ã —Ö–æ–¥–∏–ª–∏ –≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏ —á—Ç–æ –±—ã–ª–æ –ø–æ–ª—É—á–µ–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ –ë–î.

## **Presenter**

–î–µ–ª–∞–µ—Ç View –∏–∑ –±–∏–∑–Ω–µ—Å–æ–≤–æ–π –º–æ–¥–µ–ª–∏.

```swift
func didObtain(_ countries: [Country]) {
    let models = countries.map {
        UICountry(name: $0.name,
                 holder: "#",
                 prifix: $0.phoneCode,
                 mask: $0.phoneMask,
                 flag: $0.flag)
    }
    view?.display(models)
}
```

## **View**

–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è:

```swift
func display(_ profile: ProfileRenderer.ModelType, _ newsRole: NewsRoleResponse.Kind) {
    renderer.set(content: profile)
    stateRenderer.set(content: nil)
    state.newsRole = newsRole
}
```
